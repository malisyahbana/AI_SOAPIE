<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Form SOAPIE Dokter</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="container py-5">
  <h1 class="text-center mb-4">Form SOAPIE - Rekam Suara dan Input Data</h1>

  <form id="soapieForm" class="card p-4 shadow-sm">
    <div class="mb-3">
      <label class="form-label">Subjektif:</label>
      <textarea class="form-control" name="subjective" id="subjective" rows="3"
        placeholder="Masukkan data subjektif"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Objektif:</label>
      <textarea class="form-control" name="objective" id="objective" rows="3"
        placeholder="Masukkan data objektif"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Penilaian:</label>
      <textarea class="form-control" name="assessment" id="assessment" rows="3"
        placeholder="Masukkan penilaian"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Instruksi:</label>
      <textarea class="form-control" name="instruksi" id="instruksi" rows="3"
        placeholder="Masukkan instruksi"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Evaluasi:</label>
      <textarea class="form-control" name="evaluasi" id="evaluasi" rows="3" placeholder="Masukkan evaluasi"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Rencana:</label>
      <textarea class="form-control" name="plan" id="plan" rows="3" placeholder="Masukkan rencana tindakan"></textarea>
    </div>

    <div class="mb-3">
      <h3>Rekam Suara:</h3>
      <button type="button" id="recordBtn" class="btn btn-primary">Mulai Rekam</button>
      <button type="button" id="stopBtn" class="btn btn-danger" disabled>Stop Rekam</button>
    </div>
  </form>

  <script>
    let recorder;
    let audioChunks = [];
    let mediaStream;

    document.getElementById("recordBtn").onclick = function () {
      navigator.mediaDevices.getUserMedia({ audio: true })
        .then(function (stream) {
          mediaStream = stream;
          recorder = new MediaRecorder(stream);

          recorder.ondataavailable = function (event) {
            audioChunks.push(event.data);
          };

          audioChunks = [];
          recorder.start();
          document.getElementById("recordBtn").disabled = true;
          document.getElementById("stopBtn").disabled = false;
        })
        .catch(function (err) {
          console.error("Error accessing microphone: " + err);
        });
    };

    document.getElementById("stopBtn").onclick = function () {
      if (recorder) {
        recorder.stop();
        mediaStream.getTracks().forEach(track => track.stop());
        document.getElementById("recordBtn").disabled = false;
        document.getElementById("stopBtn").disabled = true;
      }
    };
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>